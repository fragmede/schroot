.\" Copyright Â© 2005  Roger Leigh <rleigh@debian.org>
.\"
.\" schroot is free software; you can redistribute it and/or modify it
.\" under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" schroot is distributed in the hope that it will be useful, but
.\" WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program; if not, write to the Free Software
.\" Foundation, Inc., 59 Temple Place, Suite 330, Boston,
.\" MA  02111-1307  USA
.TH SCHROOT.CONF 5 "11 Sep 2005" "Version @VERSION@" "Debian sbuild"
.SH NAME
schroot.conf \- chroot definition file for schroot
.SH DESCRIPTION
\fBsbuild.conf\fP is a plain UTF-8 text file, describing the chroots available
for use with sbuild.
.PP
Comments are introduced following a \[oq]\f[CR]\[sh]\fP\[cq] (\[lq]hash\[rq])
character at the beginning of a line, or following any other text.  All text
right of the \[oq]\f[CR]\[sh]\fP\[cq] is treated as a comment.
.PP
The configuration format is an INI-style format used by the GLib GKeyFile
class, and is fully documented in the GLib API reference.  Here, only the
features used and required by schroot are documented.
.SS
General options
.PP
A chroot is defined as a group of key-value pairs, which is started by a name
in square brackets on a line by itself.  The file may contain multiple groups
which therefore define multiple chroots.
.PP
A chroot definition is started by the name of the chroot in square brackets.
For example,
.IP
\f[CR]\[lB]sid\[rB]
.PP
This is then followed by several key-value pairs:
.TP
.B type=\fItype\fP
The type of the chroot.  Valid types are \[lq]plain\[rq],
\[lq]block\-device\[rq] and \[lq]lvm\-snapshot\[rq].  If empty or omitted, the
default type is \[lq]plain\[rq].
.TP
.B description=\fIdescription\fP
A short description of the chroot.
.TP
.B priority=\fInumber\fP
Set the priority of a chroot.  \fInumber\fP is a positive integer indicating
whether a distribution is older than another.  For example, \[lq]oldstable\[rq]
and \[lq]oldstable-security\[rq] might be 0, while \[lq]stable\[rq] and
\[lq]stable-security\[rq] 1, \[lq]testing\[rq] 2 and \[lq]unstable\[rq] 3.  The
values are not important, but the difference between them is.  This is used by
sbuild when using the schroot chroot mode.
.TP
.B groups=\fIgroup1,group2,...\fP
A comma-separated list of groups which are allowed access to the chroot.  If
empty or omitted, no users will be allowed access.
.TP
.B root\-groups=\fIgroup1,group2,...\fP
A comma-separated list of groups which are allowed \fBpassword-less\fP root
access to the chroot.  If empty or omitted, no users will be allowed root
access without a password (but if a user's group is in \fBgroups\fP, they may
gain access with a password).
.TP
.B aliases=\fIalias1,alias2,...\fP
A comma-separated list of aliases (alternate names) for this chroot.  For
example, a chroot named \[lq]sid\[rq] might have an \[lq]unstable\[rq] alias
for convenience.
.TP
.B max-users=\fInumber\fP
Set the maximum number of users allowed to use the chroot.  The default is 1
user, and the minimum is also 1.
.TP
.B run-setup=\fItrue\fP|\fIfalse\fP
Set whether chroot setup scripts will be run.  The default is not to run setup
scripts (\[lq]false\[rq]), for safety reasons (so it won't clobber your passwd
and other critical files).  However, if \fItype\fP is set to a value other than
\[lq]plain\[rq], setup scripts are \fBrequired\fP to mount and configure the
chroot environment.  If your chroots are exclusively controlled by schroot, set
to \[lq]true\[rq].
.SS
Plain chroots
.PP
Chroots of type \[lq]plain\[rq] are directories accessible in the filesystem.
They have an additional (mandatory) configuration option:
.TP
.B location=\fIdirectory\fP
The directory containing the chroot environment.  This is where the root will
be changed to when executing a login shell or a command.  The directory must
exist and have read and execute permissions to allow users' access to it.
.SS
Block device chroots
.PP
Chroots of type \[lq]block\-device\[rq] are a filesystem available on an
unmounted block device.  The device will be mounted and unmounted on demand.
They have additional options:
.TP
.B device=\fIdevice\fP
This is the device name of the block device, including the absolute path.  For
example, \[lq]/dev/sda5\[rq].
.TP
.B mount-options=\fImount_options\fP
Mount options for the block device.  These are additional options to pass to
mount(8).  For example, \[lq]\-o atime,sync,user_xattr\[rq].
.SS
LVM snapshot chroots
.PP
Chroots of type \[lq]lvm\-snapshot\[rq] are a filesystem available on an LVM
logical volume (LV).  A snapshot LV will be created from this LV on demand, and
then the snapshot will be mounted.  At the end of the session, the snapshot LV
will be unmounted and removed.  All of the options for \[lq]block\-device\[rq]
are available, plus an additional option:
.TP
.B lvm-snapshot-options=\fIsnapshot_options\fP
Snapshot options.  These are additional options to pass to lvcreate(8).  For
example, \[lq]\-L 2g\[rq] to create a snapshot 2 GiB in size.
.B Note:
the LV name (\[lq]\-n\[rq]), the snapshot option (\[lq]\-s\[rq]) and the
original LV path may not be specfied here; they are set automatically by
schroot.
.SH EXAMPLE
\f[CR]# Sample configuration\fP
.br
\f[CR]\fP
.br
\f[CR][sid]\fP
.br
\f[CR]description=Debian unstable\fP
.br
\f[CR]location=/srv/chroot/sid\fP
.br
\f[CR]priority=3\fP
.br
\f[CR]groups=sbuild\fP
.br
\f[CR]root-groups=root\fP
.br
\f[CR]aliases=unstable,default\fP
.br
\f[CR]\fP
.br
\f[CR][etch]\fP
.br
\f[CR]description=Debian testing\fP
.br
\f[CR]location=/srv/chroot/etch\fP
.br
\f[CR]priority=2\fP
.br
\f[CR]#groups=sbuild-security\fP
.br
\f[CR]aliases=testing\fP
.SH FILES
.TP
.I @SCHROOT_CONF@
The system-wide chroot definition file.  This file must be owned by the root
user, and not be writable by other.
.SH AUTHORS
Roger Leigh.
.SH COPYRIGHT
Copyright \(co 2005  Roger Leigh <rleigh@debian.org>
.PP
This program is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation; either version 2 of the License, or (at your option)
any later version.
.SH SEE ALSO
.BR sbuild (1),
.BR schroot (1),
.BR mount (8).
.\"#
.\"# The following sets edit modes for GNU EMACS
.\"# Local Variables:
.\"# mode:nroff
.\"# fill-column:79
.\"# End:
